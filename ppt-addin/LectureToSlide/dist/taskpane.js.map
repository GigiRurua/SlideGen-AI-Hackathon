{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/./src/taskpane/taskpane.ts"],"sourcesContent":["/* global document, Office, PowerPoint */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.PowerPoint) {\n    const syncBtn = document.getElementById(\"sync-btn\");\n    if (syncBtn) {\n      syncBtn.onclick = generateSlidesFromAI;\n    }\n  }\n});\n\nasync function generateSlidesFromAI() {\n  const codeInput = document.getElementById(\"join-code\") as HTMLInputElement;\n  const statusMsg = document.getElementById(\"status\");\n  const code = codeInput.value.trim();\n\n  if (!code || code.length !== 6) {\n    statusMsg.innerText = \"Error: Need 6 digits.\";\n    return;\n  }\n\n  try {\n    statusMsg.innerText = \"ðŸš€ Syncing with AI...\";\n    statusMsg.classList.add(\"loading-pulse\");\n\n    const url = `https://listed-transaction-screw-phantom.trycloudflare.com/fetch-slides/${code}`;\n\n    // SAFARI FIX 1: The Handshake\n    try {\n      await fetch(url, { mode: 'no-cors', cache: 'no-cache' });\n    } catch (e) {\n      console.log(\"Handshake attempted.\");\n    }\n\n    // SAFARI FIX 2: Simple Fetch\n    const response = await fetch(url, {\n      method: 'GET',\n      credentials: 'omit',\n      headers: { 'Accept': 'application/json' }\n    });\n\n    if (!response.ok) throw new Error(`HTTP ${response.status}`);\n\n    const slidesData = await response.json();\n    if (!slidesData || slidesData.length === 0) {\n      statusMsg.innerText = \"No data found for this code.\";\n      statusMsg.classList.remove(\"loading-pulse\");\n      return;\n    }\n\n    // SLIDE GENERATION LOGIC (Optimized for Mac Office 2026)\n    await PowerPoint.run(async (context) => {\n      const slides = context.presentation.slides;\n      const countResult = slides.getCount();\n      await context.sync();\n    \n      let currentCount = countResult.value;\n    \n      for (const data of slidesData) {\n        // Add slide without layout object to prevent 'InvalidArgument'\n        slides.add(); \n        await context.sync();\n    \n        const newSlide = slides.getItemAt(currentCount);\n        const shapes = newSlide.shapes;\n\n        // 1. Sidebar - Set properties individually\n        const sidebar = shapes.addGeometricShape(PowerPoint.GeometricShapeType.rectangle);\n        sidebar.left = 0;\n        sidebar.top = 0;\n        sidebar.width = 12;\n        sidebar.height = 540;\n        sidebar.fill.setSolidColor(\"#2189d1\");\n        sidebar.lineFormat.visible = false;\n    \n        // 2. Title - addTextBox(text, options)\n        const titleBox = shapes.addTextBox(data.title || \"Untitled Slide\", {\n          left: 50, top: 40, width: 620, height: 60\n        });\n        titleBox.textFrame.textRange.font.bold = true;\n        titleBox.textFrame.textRange.font.size = 32;\n        titleBox.textFrame.textRange.font.color = \"#2189d1\";\n    \n        // 3. Body Bullets - addTextBox(text, options)\n        const bodyText = Array.isArray(data.bullets) ? data.bullets.join(\"\\nâ€¢ \") : data.bullets;\n        const bodyContent = bodyText.startsWith(\"â€¢\") ? bodyText : \"â€¢ \" + bodyText;\n        const bodyBox = shapes.addTextBox(bodyContent, {\n          left: 50, top: 120, width: 620, height: 300\n        });\n        bodyBox.textFrame.textRange.font.size = 18;\n        bodyBox.textFrame.textRange.font.color = \"#333333\";\n\n        // 4. AI Speaker Notes - addTextBox(text, options)\n        const notesText = `ðŸ’¡ AI NOTES: ${data.notes || \"\"}`;\n        const notesBox = shapes.addTextBox(notesText, {\n          left: 50, top: 460, width: 620, height: 60\n        });\n        notesBox.textFrame.textRange.font.size = 10;\n        notesBox.textFrame.textRange.font.color = \"#888888\";\n        notesBox.textFrame.textRange.font.italic = true;\n    \n        currentCount++;\n        // Frequent syncs prevent buffer errors on Mac\n        await context.sync();\n      }\n      \n      statusMsg.innerText = \"âœ… Deck Generated!\";\n      statusMsg.classList.remove(\"loading-pulse\");\n    });\n  } catch (error) {\n    console.error(\"FINAL ERROR:\", error);\n    if (error.name === \"TypeError\") {\n      statusMsg.innerText = \"Security: Right-click > Inspect > Console > Click URL.\";\n    } else {\n      statusMsg.innerText = \"Error: \" + error.message;\n    }\n    statusMsg.classList.remove(\"loading-pulse\");\n  }\n}"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_createForOfIteratorHelper","Array","isArray","_arrayLikeToArray","toString","slice","constructor","name","from","test","_unsupportedIterableToArray","_n","F","s","next","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","generateSlidesFromAI","_generateSlidesFromAI","_callee2","codeInput","statusMsg","code","url","response","slidesData","_t3","_context2","document","getElementById","trim","innerText","classList","add","concat","fetch","mode","cache","console","log","method","credentials","headers","ok","Error","status","json","remove","PowerPoint","run","_ref","_callee","context","slides","countResult","currentCount","_iterator","_step","data","newSlide","shapes","sidebar","titleBox","bodyText","bodyContent","bodyBox","notesText","notesBox","_t","_context","presentation","getCount","sync","getItemAt","addGeometricShape","GeometricShapeType","rectangle","left","top","width","height","fill","setSolidColor","lineFormat","visible","addTextBox","title","textFrame","textRange","font","bold","size","color","bullets","join","startsWith","notes","italic","_x","error","message","Office","onReady","info","host","HostType","syncBtn","onclick"],"sourceRoot":""}